<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="mk">
<head>
    <meta charset="UTF-8">
    <title>Book Reservation - Choose a Book</title>
    <style>
        body { width: 800px; margin: auto; font-family: Arial, sans-serif; }
        h1, h2 { color: #333; }
        form { margin-top: 20px; }
        .book-option { margin: 10px 0; padding: 10px; border: 1px solid #ddd; border-radius: 5px; }
        .book-option:hover { background-color: #f5f5f5; }
        .search-bar { background-color: #eef; padding: 10px; border-radius: 8px; margin-bottom: 20px; }
        .search-bar input { margin-right: 10px; }
        table { border-collapse: collapse; margin-top: 30px; width: 100%; }
        th, td { border: 1px solid #aaa; padding: 8px; text-align: left; }
        th { background-color: #ddd; }
    </style>
</head>
<body>

<header>
    <h1>Welcome to our Book Reservation App</h1>
</header>

<main>
    <form class="search-bar" action="/" method="GET">
        <label for="text">Search by title:</label>
        <input type="text" id="text" name="text" placeholder="Enter part of title...">
        <label for="rating">Min rating:</label>
        <input type="number" id="rating" name="rating" step="0.1" min="0" max="10">
        <input type="submit" value="Search">
    </form>

    <form action="/bookReservation" method="POST">
        <h2>Choose a book:</h2>

        <div th:each="book : ${books}" class="book-option">
            <input type="radio" name="bookTitle" th:value="${book.title}" required>
            <span th:text="'Title: ' + ${book.title}
                + ', Genre: ' + ${book.genre}
                + ', Rating: ' + ${book.averageRating}
                + ', Author: '
                + (${book.author != null ? book.author.name + ' ' + book.author.surname : 'No author'})">
            </span>

            <a th:href="@{'/books/edit/' + ${book.id}}">Edit</a> |
            <a th:href="@{'/books/delete/' + ${book.id}}">Delete</a>
        </div>

        <h2>Your information:</h2>
        <label>Your Name:</label>
        <input type="text" name="readerName" required><br>
        <label>Your Address:</label>
        <input type="text" name="readerAddress" required><br>

        <h2>Number of copies:</h2>
        <input type="number" name="numCopies" min="1" max="10" required><br><br>

        <input type="submit" value="Reserve Book">
    </form>

    <p><a href="/books/add">Add New Book</a></p>

    <div class="reservations">
        <h2>Reservations for this book:</h2>
        <table>
            <tr>
                <th>Book Title</th>
                <th>Reader Name</th>
                <th>Reader Address</th>
                <th>Number of Copies</th>
            </tr>
            <tr th:each="r : ${reservations}">
                <td th:text="${r.bookTitle}">Book title</td>
                <td th:text="${r.readerName}">Reader name</td>
                <td th:text="${r.readerAddress}">Reader address</td>
                <td th:text="${r.numberOfCopies}">Number of copies</td>
            </tr>
        </table>
    </div>
</main>

</body>
</html>
